# Cowrie Malware Enrichment
This python script is provided by Jesse La Grew[1]<br>

This script reside on each (if you have multiple) DShield sensors that runs a cronjob daily against the cowrie.json logs to query VirusTotal SHA256 hashes and save the result.<br>
This script is used query the cowrie log hashes against the Virustotal data. To get a copy of the scrip:<br>

## Login in the DShield Sensor
$ sudo mkdir /srv/hash<br>
$ mkdir $HOME/scripts<br>
$ cd /srv/hash<br>
$ sudo wget https://raw.githubusercontent.com/jslagrew/cowrieprocessor/main/cowrie_malware_enrichment.py<br>
$ cd $HOME/scripts<br>
$ wget cowrie_vt.sh<br>
$ sudo crontab -e<br>
Change the location of the script (bold) and add the following to the crontab<br>

\# Query cowrie hash logs for the previous day<br>
0 1 * * * **/home/guy/**scripts/cowrie_vt.sh > /dev/null 2>1&<br>

$ vi cowrie_vt.sh
/usr/bin/python3 ./cowrie_malware_enrichment.py --vtapi "insert here your own VT API key" --filepath $FILE

[1] https://github.com/jslagrew/cowrieprocessor
